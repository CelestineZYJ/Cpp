//"LinearList.h"
//enum bool{ false, true };                           为何报错？？？？？？
#ifndef SEQ_H
#define SEQ_H

class LinearList{
public:
	LinearList(){};
	~LinearList(){};
	virtual int Size() const = 0;
	virtual int Length() const = 0;
	virtual int Search( int &x ) const = 0;
	virtual int Locate( int i ) const = 0;
	virtual bool getData( int i, int &x ) const = 0;
	virtual void setData( int i, int &x ) = 0;
	virtual bool Insert( int i, int &x ) = 0;
	virtual bool Remove( int i, int &x ) = 0;
	virtual bool isEmpty() const = 0 ;
	virtual bool isFull() const = 0;
	virtual void input() = 0;
	virtual void output() = 0;
//	virtual LinearList operator=( LinearList &L ) = 0;
};

#endif

//"SeqList.h"
#include <iostream>
#include <stdlib.h>
#include "LinearList.h"
using namespace std;

const int defaultSize = 100;

class SeqList: public LinearList{
protected:
	int *data;
	int maxSize;
	int last;
	void reSize( int newSize );
public:
	SeqList( int sz = defaultSize );
	SeqList( SeqList &L );
	~SeqList(){ delete []data; };
	int Size() const{ return maxSize; }
	int Length() const{ return last + 1; }
	int Search( int &x ) const;
	int Locate( int i ) const;
	bool getData( int i, int &x ) const
	{ if( i > 0 && i <= last + 1 ){ x = data[ i - 1 ]; return true; } else return false; }
	void setData( int i, int &x )
	{ if( i > 0 && i <= last + 1 ) data[ i - 1 ] = x; }
	bool Insert( int i, int &x );
	bool Remove( int i, int &x );
	bool isEmpty() const{ return ( last == -1 )? true: false; }
	bool isFull() const{ return ( last == maxSize - 1 )? true: false; }
	void findElement() const;
	
	void input();
	void output();

	SeqList operator=( SeqList &L );
};

//"memfunction.cpp"
#include "LinearList.h"
#include "SeqList.h"
using namespace std;

SeqList::SeqList( int sz ): LinearList(){
	if( sz > 0 ){
		maxSize = sz; last = -1;
		data = new int[ maxSize ];
		if( data == NULL ){
			cerr << "存储分配错误！" << endl; exit( 1 ); }
	}
}

SeqList::SeqList( SeqList &L ){
	maxSize = L.Size(); last = L.Length() - 1; int value;
	data = new int[ maxSize ];
	if( data == NULL ){
		cerr << "存储分配错误！" << endl; exit( 1 ); }
	for( int i = 0; i <= last + 1; i++ )
	    { L.getData( i, value ); data[ i - 1 ] = value;}
}

void SeqList::reSize( int newSize ){
	if( newSize <= 0 )
		cerr << "无效的数组大小！" << endl; return;
	if( newSize != maxSize ){
		int *newArray = new int[ newSize ];
		if( newArray == NULL )
			{ cerr << "存储分配错误！" << endl; exit( 1 ); }
		int n = last + 1;
		int *scrptr = data;
		int *desptr = newArray;
		while( n-- )
			*desptr++ = *scrptr++;
		delete []data;
		data = newArray; maxSize = newSize;
	}
}

int SeqList::Search( int &x ) const{
	for( int i = 0; i <= last + 1; i++ )
		if( data[ i ] == x ) return i + 1; 
	return 0;
}

int SeqList::Locate( int i ) const{
	if( i >= 1 && i <= last + 1 ) return i;
	else return 0;
}

bool SeqList::Insert( int i, int &x ){
	if( last == maxSize - 1 ) return false;
	if( i < 0 || i > last + 1 ) return false; 
	for( int j = last; j >= i; j-- )
		data[ j + 1 ] = data[ j ];
	data[ i ] = x;
	last++;
	return true;
}

bool SeqList::Remove( int i, int &x ){
	if( last == -1 ) return false;
	if( i < 1 || i > last + 1 ) return false;
	x = data[ i - 1 ];
	for( int j = i; j <= last; j++ )
		data[ j - 1 ] = data[ j ];
	last--;
	return true;
}

void SeqList::input(){
	cout << "开始建立顺序表，请输入表中最后一个元素下标：";
	while( 1 ){
		cin >> last;
		if( last <= maxSize - 1 ) break;
		cout << "表中数据有误，范围不能超过" << maxSize - 1 << ":";
	}
	for( int i = 0; i <= last; i++ )
	{ cout << "data[ " << i << " ]: "; cin >> data[ i ]; }
};

void SeqList::output(){
	cout << "顺序表当前元素最后位置为：" << last << endl;
	for( int i = 0; i <= last; i++ )
		cout << "#" << i + 1 << ":" << data[ i ] << endl;
}

SeqList SeqList::operator=( SeqList &L ){
	int value;
	if( this->maxSize == L.Size() )
		for( int i = 0; i <= last + 1; i++ )
		    { L.getData( i, value ); this->data[ i - 1 ] = value; }
	else{
		this->maxSize = L.Size(); this->last = L.Length() - 1; 
		int *newArray = new int[ maxSize ];
		if( newArray == NULL ){
			cerr << "存储分配错误！" << endl; exit( 1 ); }
	    for( int i = 0; i <= last + 1; i++ )
	        { L.getData( i, value ); newArray[ i - 1 ] = value; }
		delete []data;
		data = newArray;
	}
	return *this;
};

void SeqList::findElement() const{
	int mark = 0; int mElement = 0;
	for( int i = 0; i < Length(); ++i ){
		mark += ( data[ i ] == data[ mElement ] )? 2: -1;
		mElement = ( mark >= 0 )? mElement: mElement + 1;
	}
	if( mark < 0 )
		cout << "数组中不存在数量多于1/3的元素" << endl;
	if( mark > 0 )
		cout << "数组中的数量多于1/3的元素为：" << data[ mElement ] << endl;
	if( mark == 0 ){
		for( int i = 0; i < Length(); ++i )
			mark += ( data[ i ] == mElement )? 1: 0;
		if( mark > Length() / 3 )
			cout << "数组中的数量多于1/3的元素为：" << data[ mElement ] << endl;
		else
			cout << "数组中不存在数量多于1/3的元素" << endl;
	}
}
//"main.cpp"
#include "SeqList.h"
#include <iostream>
using namespace std;

int main(){
	SeqList list;
	list.input();
	list.output();
	list.findElement();

	system( "pause" );
	return 0;
}
